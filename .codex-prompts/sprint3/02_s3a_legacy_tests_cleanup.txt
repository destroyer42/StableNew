Fix legacy tests; rewrite brittle sleeps to bounded waits; maintain coverage; run pytest -q.
